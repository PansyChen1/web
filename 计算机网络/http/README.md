# http

## contents
- [缓存](#缓存)
- [https](#https)
- [cookie](#cookie)

### 缓存
  - 缓存命中（cache hit）
  
        可以用已有的副本为某些到达缓存的请求提供服务。这被称为缓存命中（cache hit）。
  - 缓存未命中（cache miss）
  
        其他一些到达缓存的请求可能会由于没有副本可用，而被转发给原始服务器。这被称为缓存未命中（cache miss）。
  - HTTP 再验证（revalidation）
 
        原始服务器的内容可能会发生变化，缓存要不时对其进行检测，看看它们保存的副本是否仍是服务器上最新的副本。这些“新鲜度检测”被称为 HTTP 再验证（revalidation）

 > 缓存可以在任意时刻，以任意的频率对副本进行再验证。但由于缓存中通常会包含数百万的文档，而且网络带宽是很珍贵的，所以大部分缓存只有在客户端发起请求，并且副本旧得足以需要检测的时候，才会对副本进行再验证。
 
  - 再验证命中（revalidate hit）

        缓存对缓存的副本进行再验证时，会向原始服务器发送一个小的再验证请求。如果内容没有变化，服务器会以一个小的 304 Not Modified 进行响应。只要缓存知道副本仍然有效，就会再次将副本标识为暂时新鲜的，并将副本提供给客户端这被称作再验证命中（revalidate hit）或缓慢命中（slow hit）。这种方式确实要与原始服务器进行核对，所以会比单纯的缓存命中要慢，但它没有从服务器中获取对象数据，所以要比缓存未命中快一些。

 > 字节命中率表示的是缓存提供的字节在传输的所有字节中所占的比例。通过这种度量方式，可以得知节省流量的程度。
 
浏览器缓存机制
浏览器是如何判断缓存是否过期？
应该是根据Response Header里面的Cache-Control和Expires这两个属性，当两个都存在时，Cache-Control优先级较高。
浏览器缓存分为：强缓存和协商缓存。

1、==强缓存==：浏览器加载资源时，第一步先判断它是否是强缓存，如果是，浏览器将直接从自己的缓存中读取，不会向服务器发送请求。
上图，status200，Size是from memory cache就是走的强缓存。那么什么是强缓存呢？浏览器又是咋判断的呢？

==Expires字段==：

1、浏览器第一次向服务器请求，服务器返回资源并在response header加上Expires字段，是客户端缓存有效期，是绝对时间。
2、浏览器接收资源，把资源和相应头缓存起来。
3、待到再次请求这个资源时，先在缓存中找，找到了看Expires字段，判断是否过期。若没过期直接从缓存加载。若过期了，再向服务器请求。
==Cache-Control字段==：

1、浏览器第一次向服务器请求，服务器返回资源并在response header加上Cache-Control字段，也是缓存的有效期，但是是相对时间，比如：Cache-Control:max-age=56700000。
2、浏览器接收资源，把资源和相应头缓存下来。
3、待到浏览器再次请求这个资源时，先在缓存找，根据第一次的请求时间和Cache-Control相对时间算出过期时间。若没过期，直接从缓存加载。若过期了，再向服务器请求。
==Expires字段==但是绝对时间有时会有偏差，所以引出了==Cache-Control==。
==Cache-Control==弥补了==Expires==的不足，更安全有效。

服务端如何判断缓存已失效？
服务端通过If-Modified-Since（Last-Modified）和If-None-Match（Etag）这两个属性的值来判断缓存是否失效的。

2、==协商缓存==：当浏览器判断不是强缓存，就会发向服务器发请求，判断是否是协商缓存。如果是，服务器会返回304Not Modified，浏览器从缓存中加载。那什么又是协商缓存呢？

==Last-Modified==和==If-Modified-Since==字段：

1、浏览器第一次向服务器发请求，服务器返回资源并在response header加上Last-Modified字段，表示资源最后修改的时间。
2、浏览器再次请求这个资源时，请求头会加上If-Modified-Since字段。若这两个字段一样，说明资源没有修改过，返回304Not Modified，浏览器从缓存中获取资源。若这两个字段不一样，说明资源修改过，服务器正常返回资源。
==ETag、If-None-Match==：

但有时候服务器上资源有变化，单最后修改时间没更新，则引出下面两个字段。
1、浏览器第一次向服务器请求，服务器返回资源并在response header上加ETag字段。表示资源本身，资源有变化，则该字段有变化。
2、浏览器再次向服务器请求这个资源时，请求头携带If-None-Match字段。若这两个字段相同，则代表资源没有变化，服务器返回304Not Modified，浏览器从缓存中加载。若两个字段不同，证明资源有变动，服务器正常返回资源。


### https
- SSL协议： 
  - SSL记录协议（SSL Record Protocol）

        它建立在可靠的传输协议（如TCP）之上，为高层协议提供数据封装、压缩、加密等基本功能的支持。 
  - SSL握手协议（SSL Handshake Protocol）
  
        它建立在SSL记录协议之上，用于在实际的数据传输开始前，通讯双方进行身份认证、协商加密算法、交换加密密钥等。
### cookie

    Cookie的作用是与服务器进行交互，作为HTTP规范的一部分而存在。
- 了解cookie
  - 要表示唯一的一个cookie值需要：name、domain、path
  - 一个cookie就是一个小型的文本文件
  - 虽然cookie保存在浏览器端，但是一般是在服务器端设置的。
  - 可以在HTTP返回体里，通过设置Set-Cookie来告诉浏览器端所要存储的cookie。
  - 用来保存客户浏览器请求服务器页面的请求信息
